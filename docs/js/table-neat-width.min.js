window.NACSS=window.NACSS||{},function(t){function e(t,e){const n=document.createElement(e);return n.setAttribute("style","position:fixed;display:inline-block;visibility:hidden;white-space:nowrap;"),t.appendChild(n)}function n(t,e){t.removeChild(e.dcTd),t.removeChild(e.dcTh)}function o(t,e){if(0===t.rows.length)return!1;if(e.maxRowSize<t.rows.length)return!1;const{cellMinWidth:n,cellMinAspect:o}=e;for(const e of t.rows)if(e.hasChildNodes())for(const t of e.childNodes){const e=t.tagName;if("TD"!==e&&"TH"!==e)continue;if(1<parseInt(t.getAttribute("colSpan"),10))continue;if(1<parseInt(t.getAttribute("rowSpan"),10))continue;const i=t.clientWidth,l=t.clientHeight;if(i<n||i/l<o)return!0}return!1}function i(t,e){if(t.scrollWidth-t.clientWidth>2){const n=t.scrollLeft/(t.scrollWidth-t.clientWidth);c(n<.95,t,e.styleScrollRight),c(.05<n,t,e.styleScrollLeft)}else c(!1,t,e.styleScrollRight),c(!1,t,e.styleScrollLeft)}function l(t,e){t.removeAttribute("width"),t.style.width&&(t.style.width=null),t.style.height&&(t.style.height=null);const n=function(t){const e=function(t,e=[]){for(const n of t.rows){const t=[];if(n.hasChildNodes())for(const e of n.childNodes){const n=e.tagName;"TD"!==n&&"TH"!==n||t.push(e)}e.push(t)}return e}(t);let n=0;for(const t of e)n=Math.max(n,t.length);const o=[];for(const t of e)o.push(new Array(n));for(let t=0;t<o.length;t+=1){const i=o[t],l=e[t];let r=0;for(let e=0;e<n;e+=1){if("number"==typeof i[e]||null===i[e])continue;const n=l[r],c=parseInt(n.getAttribute("colSpan")??1,10),s=parseInt(n.getAttribute("rowSpan")??1,10);if(i[e]=n,1<c)for(let t=1;t<c;t+=1)i[e+t]=t;if(1<s)for(let n=1;n<s;n+=1){const i=o[t+n];for(let t=0;t<c;t+=1)i[e+t]=null}if(r+=1,l.length<=r)break}}return o}(t),o=Object.assign(function(t,e){const n=t.clientWidth,o=[];for(let t=0;t<e[0].length;t+=1)for(let n=0;n<e.length;n+=1){const i=e[n][t];if(i instanceof HTMLTableCellElement&&!i.getAttribute("colSpan")){o.push(i.clientWidth);break}}return{origTabW:n,origCellWs:o}}(t,n),e),i=function(t,e){for(const e of t)for(const t of e)"number"!=typeof t&&null!==t&&(t.style.whiteSpace="nowrap");const n=t[0].length,o=new Array(n).fill(0),i=new Array(n).fill(0);for(const l of t)for(let t=0;t<n;t+=1){const c=l[t];if(null==c||"number"==typeof c)continue;if(t<n-1&&"number"==typeof l[t+1])continue;if(1<parseInt(c.getAttribute("colSpan"),10))continue;if(1<parseInt(c.getAttribute("rowSpan"),10))continue;const s=r(c,e);o[t]=Math.max(o[t],s),s||(i[t]=Math.max(i[t],c.clientWidth))}return function(t,e,n){const{origTabW:o,origCellWs:i}=n;let l=0,r=0;for(let n=0;n<t.length;n+=1)t[n]?l+=t[n]:r+=e[n];if(o<l+r)return;let c=o-r;for(let e=0;e<t.length;e+=1){if(!t[e])continue;const n=t[e],o=Math.min(n/l*c,i[e]);c-=o-n,l-=o-n,t[e]=0|o}}(o,i,e),o}(n,o);!function(t,e){for(const n of t)for(let t=0;t<n.length;t+=1){const o=n[t],i=e[t];i&&o instanceof HTMLTableCellElement&&(o.style.whiteSpace=null,o.style.minWidth=i+"px",o.style.width=null)}}(n,i);const l=t.getElementsByTagName("caption");l.length&&(l[0].innerHTML=`<span>${l[0].innerHTML}</span>`)}function r(t,e){const{padH:n,padV:o,charW:i,lineH:l,dcTd:r,dcTh:c,cellMinWidth:s,cellMinAspect:a,cellMinLength:f}=e;if(function(t){const e=t.innerHTML.trim(),n=e.split(/<\s*br\s*\/?>/iu).map((t=>t.replace(/<("[^"]*"|'[^']*'|[^'">])*>/g,"").length));return Math.max(...n)}(t)<f)return 0;t.innerHTML=t.innerHTML.trim();const d="TD"===t.tagName?r:c;d.innerHTML=t.innerHTML;const h=d.clientWidth-n,u=Math.round((d.clientHeight-o)/l);let p=0;for(let t=2;;t+=1){const e=0|h/t+i*t+n,r=u*(t*l)+o;if(e<s||e/r<a||p&&p<e)break;p=e}return p+i<d.clientWidth?p:0}function c(t,e,n){const o=n.substr(1);n.startsWith(":")?t?e.dataset[o]="":delete e.dataset[o]:t?e.classList.add(o):e.classList.remove(o)}function s(t){let e;return(...n)=>{e||(e=!0,requestAnimationFrame((()=>{e=!1,t(...n)})))}}window["NACSS"].tableNeatWidth=function(t,r={}){if(0===t.length)return;const a=t[t.length-1],f=Object.assign({fullWidthRate:.95,cellMinWidth:80,cellMinAspect:2/3,cellMinLength:8,maxRowSize:200,maxBorderWidth:2,before:null,after:null,styleNeat:":ncTableNeat",styleFull:":ncTableFull",styleScrollRight:":ncScrollRight",styleScrollLeft:":ncScrollLeft"},r,function(t){const e=t.getElementsByTagName("td")[0],n=getComputedStyle(e),o=parseFloat(n.paddingLeft)+parseFloat(n.paddingRight),i=parseFloat(n.paddingTop)+parseFloat(n.paddingBottom),[l,r]=function(t){const e=document.createElement(t.nodeName);e.setAttribute("style",`position:fixed;margin:0;padding:0;font-family:${t.style.fontFamily||"inherit"};font-size:${t.style.fontSize||"inherit"};`),e.innerHTML="ã€€",t.parentNode.appendChild(e);const n=e.clientWidth,o=e.clientHeight;return e.parentNode.removeChild(e),[n,o]}(e);return{padH:o,padV:i,charW:l,lineH:r}}(a));f.padH+=2*f.maxBorderWidth,f.padV+=2*f.maxBorderWidth,f.dcTd=e(a,"td"),f.dcTh=e(a,"th");const d=[],h=[];for(const e of t)o(e,f)?d.push(e):h.push(e);f.gcCount=d.length;for(const t of d){const e=!!f.before&&(f.before(t)??0);u=()=>{l(t,f),c(!0,t,f.styleNeat),f.after&&f.after(t),0==--f.gcCount&&n(a,f)},!1===(p=e)?u():setTimeout(u,p)}var u,p;if(f.fullWidthRate)for(const t of h){t.parentElement.clientWidth*f.fullWidthRate<t.clientWidth&&c(!0,t,f.styleFull)}!function(t,e){const n=new ResizeObserver((t=>{for(const n of t)i(n.target,e)}));for(const o of t)n.observe(o),o.addEventListener("scroll",s((()=>{i(o,e)})))}(d,f)};const a=[];document.addEventListener("DOMContentLoaded",(()=>{window.addEventListener("resize",(()=>{for(const t of a)t()}),{passive:!0})}))}();
//# sourceMappingURL=table-neat-width.min.js.map